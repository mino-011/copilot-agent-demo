## scripts/fetch_meeting_notes.py
import requests

ACCESS_TOKEN = "YOUR_GRAPH_API_TOKEN"
MEETING_ID = "YOUR_MEETING_ID"

def fetch_meeting_transcript():
    """
    Fetch meeting transcript from Microsoft Graph API.
    """
    url = f"https://graph.microsoft.com/v1.0/communications/onlineMeetings/{MEETING_ID}/transcripts"
    headers = {"Authorization": f"Bearer {ACCESS_TOKEN}"}
    response = requests.get(url, headers=headers)

    if response.status_code == 200:
        transcript = response.json()
        return transcript.get("content", "")
    else:
        raise Exception(f"Error: {response.status_code} - {response.text}")

if __name__ == "__main__":
    print(fetch_meeting_transcript())

## scripts/summarize_action_items.py
import openai

openai.api_key = "YOUR_AZURE_OPENAI_KEY"

def summarize(transcript):
    """
    Summarize meeting transcript and extract action items.
    """
    prompt = f"""
    以下は会議の議事録です。
    1. 3行以内の要約
    2. アクションアイテム（To Do形式）を出力してください。

    ---
    {transcript}
    """

    response = openai.Completion.create(
        engine="gpt-4",
        prompt=prompt,
        max_tokens=500
    )
    return response.choices[0].text.strip()

if __name__ == "__main__":
    sample_transcript = "本日は新製品の発売日程を決定..."
    print(summarize(sample_transcript))
